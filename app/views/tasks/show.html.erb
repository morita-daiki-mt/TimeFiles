<%= form_for(@task) do |f| %>
  <div class="show_taskinfo">
    <div class="show_icon">
      <p><%= image_tag @task.icon.url %></p>
      <div class="custom-file">
        <%= f.file_field :icon, class: 'custom-file-input', id: 'customFile', accept: "image/png,image/jpeg,image/gif" %>
        <label class="custom-file-label" for="customFile" data-browse="参照">ファイル選択...</label>
      </div>
    </div>
    <h3><%= f.text_field :content, class: 'border-bottom', style: 'border: none' %></h3>
    <% if @histories.present? %>
      <h5><%= (Date.today - @histories.first.action_at).to_i %>日経過</h5> 
    <% else %>
      <h5>まだタスクを行っていません</h5>
    <% end %>
  </div>
  <%= f.text_area :memo %>
  <%= f.submit '更新' %>
<% end %>

<%#======================================%>
<%= form_with(model:[@task, @history]) do |history| %>
  <%= history.hidden_field :task_id, :value => @task.id %>
  <div class="input-group date" data-target-input="nearest">
      <label class = "control-label" for="">実行日追加</label>
      <%= history.text_field :action_at, id: "action_at", class: 'form-control datetimepicker-input', data: { target: '#action_at'}, required: true %>
      <span class = "input-group-append" data-target = "#action_at" data-toggle = "datetimepicker">
          <span class = "input-group-text"><i class = "fa fa-calendar"></i></span>
      </span>
  </div>
  <%= history.submit '作成' %>
<% end %>
<%#======================================%>
<ul>
  <% @histories.each do |history| %>
    <li><%= history.action_at %></li>
    <button type="button" class="btn btn-dark btn-sm"><%= link_to '削除', task_history_path(@task, history), method: :delete, data: { confirm: '記録を削除しますか?' } %></button>
  <% end %>
</ul>
<button type="button" class="btn btn-dark btn-sm"><%= link_to '削除', @task, method: :delete, data: { confirm: 'タスクを削除しますか?' } %></button>
<button type="button" class="btn btn-info btn-sm"><%= link_to '一覧へ戻る', root_path %></button>